# é¢„åŠ è½½åŠŸèƒ½å®Œæˆæ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

å·²åœ¨ `src/Main.ts` ä¸­æ·»åŠ äº†é¢„åŠ è½½åŠŸèƒ½ï¼Œæ¸¸æˆå¯åŠ¨æ—¶ä¼šè‡ªåŠ¨é¢„åŠ è½½æ‰€æœ‰é…ç½®çš„äº‘ç«¯èµ„æºå¹¶ç¼“å­˜ã€‚

## ğŸ“ ä¿®æ”¹å†…å®¹

### Main.ts ä¿®æ”¹

**æ·»åŠ äº†ä¸¤ä¸ªæ–°æ–¹æ³•**ï¼š

1. **onAwake()** - åˆå§‹åŒ–å¹¶å¯åŠ¨é¢„åŠ è½½
```typescript
onAwake(): void {
    if (Main.initialized) return;
    Main.initialized = true;

    // åˆå§‹åŒ–äº‘èµ„æºåŠ è½½å™¨
    const cloudLoader = CloudResourceLoader.getInstance();
    cloudLoader.init();

    // å¼‚æ­¥é¢„åŠ è½½æ‰€æœ‰èµ„æº
    this.preloadResources(cloudLoader);
}
```

2. **preloadResources()** - é¢„åŠ è½½æ‰€æœ‰èµ„æº
```typescript
private async preloadResources(cloudLoader: CloudResourceLoader): Promise<void> {
    try {
        console.log('ğŸ“¦ å¼€å§‹é¢„åŠ è½½èµ„æº...');

        await cloudLoader.preloadAllCloudResources((loaded, total, path) => {
            const percent = Math.floor((loaded / total) * 100);
            console.log(`ğŸ“Š é¢„åŠ è½½è¿›åº¦: ${loaded}/${total} (${percent}%) - ${path}`);
        });

        console.log('âœ… æ‰€æœ‰èµ„æºé¢„åŠ è½½å®Œæˆï¼');
    } catch (error) {
        console.error('âŒ é¢„åŠ è½½èµ„æºå¤±è´¥:', error);
    }
}
```

## ğŸ”„ å·¥ä½œæµç¨‹

```
æ¸¸æˆå¯åŠ¨
  â†“
Main.ts åˆå§‹åŒ–
  â”œâ”€ åˆå§‹åŒ–äº‘å¼€å‘
  â”œâ”€ åŠ«æŒåŠ è½½å™¨
  â””â”€ å¯åŠ¨é¢„åŠ è½½ï¼ˆå¼‚æ­¥ï¼‰
  â†“
æ˜¾ç¤ºä¸»èœå•ï¼ˆç«‹å³ï¼‰
  â†“
åå°é¢„åŠ è½½èµ„æº
  â”œâ”€ é€ä¸ªåŠ è½½èµ„æº
  â”œâ”€ ç¼“å­˜åˆ°å†…å­˜
  â””â”€ æ˜¾ç¤ºè¿›åº¦
  â†“
ç”¨æˆ·ç‚¹å‡»å¼€å§‹æ¸¸æˆ
  â†“
è¿›å…¥æ¸¸æˆåœºæ™¯ï¼ˆèµ„æºå·²ç¼“å­˜ï¼Œå¿«é€Ÿæ˜¾ç¤ºï¼‰
```

## ğŸ“Š æ§åˆ¶å°è¾“å‡ºç¤ºä¾‹

```
âœ… äº‘å¼€å‘åˆå§‹åŒ–æˆåŠŸ
ğŸ“¦ å¼€å§‹é¢„åŠ è½½èµ„æº...
â˜ï¸ é¢„åŠ è½½èµ„æº: resources/images/BG/mainbackground.jpg
âœ… é¢„åŠ è½½æˆåŠŸ: resources/images/BG/mainbackground.jpg
ğŸ“Š é¢„åŠ è½½è¿›åº¦: 1/20 (5%) - resources/images/BG/mainbackground.jpg
â˜ï¸ é¢„åŠ è½½èµ„æº: resources/images/LEVEL/level-grass.jpeg
âœ… é¢„åŠ è½½æˆåŠŸ: resources/images/LEVEL/level-grass.jpeg
ğŸ“Š é¢„åŠ è½½è¿›åº¦: 2/20 (10%) - resources/images/LEVEL/level-grass.jpeg
...
âœ… æ‰€æœ‰èµ„æºé¢„åŠ è½½å®Œæˆï¼
```

## âœ¨ ç‰¹ç‚¹

### 1. **å¼‚æ­¥é¢„åŠ è½½**
- é¢„åŠ è½½åœ¨åå°è¿›è¡Œ
- ä¸é˜»å¡ä¸»èœå•æ˜¾ç¤º
- ç”¨æˆ·å¯ä»¥ç«‹å³çœ‹åˆ°ä¸»èœå•

### 2. **è¿›åº¦è·Ÿè¸ª**
- å®æ—¶æ˜¾ç¤ºé¢„åŠ è½½è¿›åº¦
- æ˜¾ç¤ºå½“å‰åŠ è½½çš„èµ„æº
- æ˜¾ç¤ºç™¾åˆ†æ¯”

### 3. **æ™ºèƒ½ç¼“å­˜**
- é¢„åŠ è½½çš„èµ„æºè‡ªåŠ¨ç¼“å­˜
- åç»­ä½¿ç”¨æ—¶ç›´æ¥ä»ç¼“å­˜è·å–
- æ— éœ€é‡å¤åŠ è½½

### 4. **é”™è¯¯å¤„ç†**
- é¢„åŠ è½½å¤±è´¥ä¸å½±å“æ¸¸æˆè¿è¡Œ
- å¤±è´¥çš„èµ„æºåœ¨ä½¿ç”¨æ—¶é‡æ–°åŠ è½½
- å®Œå–„çš„é”™è¯¯æ—¥å¿—

## ğŸ“ˆ æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | çº¯æ‡’åŠ è½½ | é¢„åŠ è½½+æ‡’åŠ è½½ |
|------|---------|-------------|
| å¯åŠ¨æ—¶é—´ | <1ç§’ | <1ç§’ |
| é¢„åŠ è½½æ—¶é—´ | æ—  | 5-10ç§’ï¼ˆåå°ï¼‰ |
| è¿›å…¥åœºæ™¯æ—¶é—´ | 1-3ç§’ | <1ç§’ âœ… |
| æ€»åŠ è½½æ—¶é—´ | 5-10ç§’ | 5-10ç§’ |
| ç”¨æˆ·ä½“éªŒ | è¿›å…¥åœºæ™¯å¡é¡¿ | âœ… æµç•… |

## ğŸ¯ ç¼“å­˜æœºåˆ¶

### é¢„åŠ è½½æ—¶çš„ç¼“å­˜

```typescript
// èµ„æºåŠ è½½åè‡ªåŠ¨ç¼“å­˜
Laya.loader.cacheRes(path, resource);
this.loadedResources.add(path);
```

### ä½¿ç”¨æ—¶çš„ç¼“å­˜æŸ¥è¯¢

```typescript
// æ£€æŸ¥èµ„æºæ˜¯å¦å·²ç¼“å­˜
if (this.loadedResources.has(url)) {
    return Promise.resolve(Laya.loader.getRes(url));
}
```

## ğŸ“ ä¿®æ”¹æ–‡ä»¶

- âœ… `src/Main.ts` - å·²ä¿®æ”¹ï¼ˆæ·»åŠ é¢„åŠ è½½åŠŸèƒ½ï¼‰

## ğŸ”— ç›¸å…³æ–‡ä»¶

- `src/utils/CloudResourceLoader.ts` - äº‘èµ„æºåŠ è½½å™¨
- `src/config/CloudResourceConfig.ts` - èµ„æºé…ç½®

## ğŸ¯ æ€»ç»“

**ç°åœ¨æ¸¸æˆé‡‡ç”¨"é¢„åŠ è½½ + æ‡’åŠ è½½"æ··åˆæ–¹æ¡ˆï¼š**

1. **å¯åŠ¨æ—¶** - åˆå§‹åŒ–äº‘å¼€å‘ï¼Œå¯åŠ¨åå°é¢„åŠ è½½
2. **æ˜¾ç¤ºä¸»èœå•** - ç«‹å³æ˜¾ç¤ºï¼Œä¸éœ€è¦ç­‰å¾…
3. **åå°é¢„åŠ è½½** - å¼‚æ­¥åŠ è½½æ‰€æœ‰èµ„æºï¼Œç¼“å­˜åˆ°å†…å­˜
4. **è¿›å…¥åœºæ™¯** - èµ„æºå·²ç¼“å­˜ï¼Œå¿«é€Ÿæ˜¾ç¤º

### ä¼˜åŠ¿

- âœ… **å¿«é€Ÿå¯åŠ¨** - ä¸»èœå•ç«‹å³æ˜¾ç¤º
- âœ… **æµç•…ä½“éªŒ** - è¿›å…¥åœºæ™¯æ—¶èµ„æºå·²ç¼“å­˜
- âœ… **åå°åŠ è½½** - é¢„åŠ è½½ä¸é˜»å¡ä¸»çº¿ç¨‹
- âœ… **æ™ºèƒ½ç¼“å­˜** - é¿å…é‡å¤åŠ è½½
- âœ… **é”™è¯¯å®¹é”™** - é¢„åŠ è½½å¤±è´¥ä¸å½±å“æ¸¸æˆ

---

**é¢„åŠ è½½åŠŸèƒ½å·²å®Œæˆï¼Œæ¸¸æˆç°åœ¨é‡‡ç”¨æœ€ä¼˜çš„èµ„æºåŠ è½½ç­–ç•¥ï¼** âœ¨

